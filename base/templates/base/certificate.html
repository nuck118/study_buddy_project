{% extends 'base/main.html' %}

{% block content %}
<!-- Confetti Animation Script -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

<div class="max-w-4xl mx-auto text-center py-10">
    
    <!-- Celebration Header -->
    <div class="mb-8">
        <div class="inline-block p-4 rounded-full bg-yellow-100 text-yellow-600 mb-4 text-5xl animate-bounce">
            üèÜ
        </div>
        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Congratulations, {{ cert.user.username }}!</h1>
        <p class="text-xl text-gray-500">You have officially mastered <span class="text-indigo-600 font-bold">{{ cert.subject.name }}</span>.</p>
    </div>

    <!-- The Certificate Image -->
    <div class="bg-white p-4 rounded-2xl shadow-2xl border border-gray-200 inline-block mb-10 transform hover:scale-[1.02] transition-transform">
        <img src="{{ cert.image.url }}" alt="Certificate" class="max-w-full h-auto rounded-lg md:max-w-2xl border border-gray-100">
    </div>

    <!-- Share Actions -->
    <div class="bg-indigo-50 rounded-2xl p-8 max-w-2xl mx-auto">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Show off your achievement!</h3>
        
        <div class="flex flex-col sm:flex-row justify-center gap-4">
            
            <!-- Download Button -->
            <a href="{{ cert.image.url }}" download="StudyBuddy_Certificate.png" class="flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-6 rounded-xl transition">
                <i class="fa-solid fa-download"></i> Download
            </a>

            <!-- LinkedIn Share -->
            <!-- Note: On localhost, LinkedIn cannot 'see' your image URL. 
                 On a real domain, you would pass the image URL directly. -->
            <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}" target="_blank" class="flex items-center justify-center gap-2 bg-[#0077b5] hover:bg-[#006097] text-white font-bold py-3 px-6 rounded-xl transition shadow-lg shadow-blue-200">
                <i class="fa-brands fa-linkedin"></i> Share on LinkedIn
            </a>

            <!-- Twitter/X Share -->
            <a href="https://twitter.com/intent/tweet?text=I%20just%20completed%20the%20{{ cert.subject.name }}%20course%20on%20Study%20Buddy!%20%23Learning%20%23StudyBuddy" target="_blank" class="flex items-center justify-center gap-2 bg-black hover:bg-gray-800 text-white font-bold py-3 px-6 rounded-xl transition shadow-lg shadow-gray-300">
                <i class="fa-brands fa-x-twitter"></i> Post
            </a>

        </div>
        <p class="text-xs text-gray-400 mt-4">
            *Note: To share the image on social media while testing on localhost, please "Download" it first and upload it manually.
        </p>
    </div>

</div>

<!-- Auto Trigger Confetti -->
<script>
    window.onload = function() {
        var duration = 3 * 1000;
        var animationEnd = Date.now() + duration;
        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

        function random(min, max) { return Math.random() * (max - min) + min; }

        var interval = setInterval(function() {
            var timeLeft = animationEnd - Date.now();
            if (timeLeft <= 0) { return clearInterval(interval); }
            var particleCount = 50 * (timeLeft / duration);
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
        }, 250);
    };
</script>
{% endblock %}